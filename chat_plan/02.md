[Task 2] 채팅 메시지 리스트 가상화 아키텍처 설계

[전제]
- react-virtuoso 코어만 사용한다 (MessageList 유료 API는 사용하지 않음).
- 메시지는 여러 줄 텍스트와 이미지가 섞일 수 있고, 높이는 완전히 가변이다.
- 이전 메시지 로딩은 "위로 스크롤 → 오래된 페이지 무한 스크롤" 패턴이다.
- 새 메시지는 Supabase Realtime으로 받는다.

1) 라이브러리/구조 선택
   - 현재 코드베이스 구조를 기준으로,
     - 메시지 리스트에 react-virtuoso <Virtuoso>를 도입하는 방식을 제안해줘.
   - 이때, TanStack Virtual을 유지할지 / 제거할지에 대한 의견도 같이 적어줘.
     - 기본 방침은 "게시글/상점 등 기존 영역은 그대로, 채팅만 Virtuoso 사용"을 가정.

2) 컴포넌트/훅 인터페이스 설계
   - 아래 형태의 컴포넌트를 기준으로 인터페이스/props를 설계해줘:

     - <ChatMessageList
          messages: Message[]
          hasMoreBefore: boolean
          isLoadingMoreBefore: boolean
          onLoadMoreBefore: () => Promise<void>
          onReachBottomChange?: (isAtBottom: boolean) => void
        />

   - Message 타입 정의 (id, roomId, senderId, createdAt, content, imageUrl 등)
     을 TypeScript 인터페이스로 제안해줘.
   - ChatMessageList 내부에서 Virtuoso에 넘길 props 구조
     (data, itemContent, startReached, followOutput, alignToBottom 등)를 설계해줘.:contentReference[oaicite:5]{index=5}

3) 상태/데이터 흐름 설계
   - useInfiniteQuery를 사용하는 경우를 가정하고,
     - pageParam / getPreviousPageParam 구조
     - Supabase Realtime에서 받은 새 메시지를 어떻게 현재 pages 구조에 병합할지
     를 설계해줘.
   - "맨 아래에 있을 때만 새 메시지 자동 스크롤"을 followOutput 또는
     별도 상태 계산으로 어떻게 구현할지 아이디어를 적어줘.:contentReference[oaicite:6]{index=6}

4) 출력 형식
   - "고수준 다이어그램(텍스트)" → 어떤 훅/컴포넌트가 어떤 데이터 흐름으로 연결되는지
   - TypeScript 타입/컴포넌트 시그니처
   - Virtuoso에 넘길 props 예시 코드
   를 포함해서 답변해라.
